<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 6 Series Temporales | Ciencia de Datos - UMA</title>
  <meta name="description" content="Material usado como Introducción a Ciencia de Datos - ETSI Informática" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 6 Series Temporales | Ciencia de Datos - UMA" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Material usado como Introducción a Ciencia de Datos - ETSI Informática" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 6 Series Temporales | Ciencia de Datos - UMA" />
  
  <meta name="twitter:description" content="Material usado como Introducción a Ciencia de Datos - ETSI Informática" />
  

<meta name="author" content="Domingo López, Ángel Mora" />


<meta name="date" content="2023-09-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelling-techniques.html"/>
<link rel="next" href="clustering.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Ciencia de datos con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html"><i class="fa fa-check"></i><b>2</b> Análisis Exploratorio de Datos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#importación-de-datos"><i class="fa fa-check"></i><b>2.1</b> Importación de datos</a></li>
<li class="chapter" data-level="2.2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#dplyr-para-manipulación-de-datos"><i class="fa fa-check"></i><b>2.2</b> <code>dplyr</code> para Manipulación de Datos</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#backends"><i class="fa fa-check"></i><b>2.2.1</b> Backends</a></li>
<li class="chapter" data-level="2.2.2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#filtrado-de-filas-con-filter"><i class="fa fa-check"></i><b>2.2.2</b> Filtrado de filas con <code>filter()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#ordenar-filas-con-arrange"><i class="fa fa-check"></i><b>2.3</b> Ordenar filas con <code>arrange()</code></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#selección-de-columnas-select"><i class="fa fa-check"></i><b>2.3.1</b> Selección de columnas <code>select()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#añadir-o-renombrar-variables-con-mutate"><i class="fa fa-check"></i><b>2.4</b> Añadir o renombrar variables con <code>mutate()</code></a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#rename"><i class="fa fa-check"></i><b>2.4.1</b> <code>rename()</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#uso-del-operador"><i class="fa fa-check"></i><b>2.4.2</b> Uso del operador <code>%&gt;%</code></a></li>
<li class="chapter" data-level="2.4.3" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#otros-verbos-auxiliares"><i class="fa fa-check"></i><b>2.4.3</b> Otros verbos auxiliares</a></li>
<li class="chapter" data-level="2.4.4" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#operaciones-con-dos-tablas"><i class="fa fa-check"></i><b>2.4.4</b> Operaciones con dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#proyecto-starwarks"><i class="fa fa-check"></i><b>2.5</b> Proyecto Starwarks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="algebra-lineal.html"><a href="algebra-lineal.html"><i class="fa fa-check"></i><b>3</b> Algebra Lineal</a>
<ul>
<li class="chapter" data-level="3.1" data-path="algebra-lineal.html"><a href="algebra-lineal.html#grandes-sistemas"><i class="fa fa-check"></i><b>3.1</b> grandes sistemas</a></li>
<li class="chapter" data-level="3.2" data-path="algebra-lineal.html"><a href="algebra-lineal.html#matrices-dispersas"><i class="fa fa-check"></i><b>3.2</b> matrices dispersas</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="test-estadísticos-bayesiano.html"><a href="test-estadísticos-bayesiano.html"><i class="fa fa-check"></i><b>4</b> Test estadísticos bayesiano</a></li>
<li class="chapter" data-level="5" data-path="modelling-techniques.html"><a href="modelling-techniques.html"><i class="fa fa-check"></i><b>5</b> Modelling techniques</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelling-techniques.html"><a href="modelling-techniques.html#interpolation"><i class="fa fa-check"></i><b>5.1</b> Interpolation</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="modelling-techniques.html"><a href="modelling-techniques.html#polynomial-interpolation"><i class="fa fa-check"></i><b>5.1.1</b> Polynomial interpolation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="modelling-techniques.html"><a href="modelling-techniques.html#linear-regression"><i class="fa fa-check"></i><b>5.2</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="modelling-techniques.html"><a href="modelling-techniques.html#linear-regression-in-r"><i class="fa fa-check"></i><b>5.2.1</b> Linear Regression in R</a></li>
<li class="chapter" data-level="5.2.2" data-path="modelling-techniques.html"><a href="modelling-techniques.html#lm-function"><i class="fa fa-check"></i><b>5.2.2</b> <strong>lm()</strong> function</a></li>
<li class="chapter" data-level="5.2.3" data-path="modelling-techniques.html"><a href="modelling-techniques.html#evaluate-the-model"><i class="fa fa-check"></i><b>5.2.3</b> Evaluate the model</a></li>
<li class="chapter" data-level="5.2.4" data-path="modelling-techniques.html"><a href="modelling-techniques.html#accuracy-of-the-model"><i class="fa fa-check"></i><b>5.2.4</b> Accuracy of the model</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modelling-techniques.html"><a href="modelling-techniques.html#generalized-regression"><i class="fa fa-check"></i><b>5.3</b> Generalized Regression</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modelling-techniques.html"><a href="modelling-techniques.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.3.1</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="5.3.2" data-path="modelling-techniques.html"><a href="modelling-techniques.html#evaluating-the-regression-coefficients"><i class="fa fa-check"></i><b>5.3.2</b> Evaluating the Regression Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="modelling-techniques.html"><a href="modelling-techniques.html#improving-the-models"><i class="fa fa-check"></i><b>5.4</b> Improving the models</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="modelling-techniques.html"><a href="modelling-techniques.html#updating-the-models"><i class="fa fa-check"></i><b>5.4.1</b> Updating the models</a></li>
<li class="chapter" data-level="5.4.2" data-path="modelling-techniques.html"><a href="modelling-techniques.html#searching-the-best-regression"><i class="fa fa-check"></i><b>5.4.2</b> Searching the best regression</a></li>
<li class="chapter" data-level="5.4.3" data-path="modelling-techniques.html"><a href="modelling-techniques.html#orthogonal-polynomials"><i class="fa fa-check"></i><b>5.4.3</b> Orthogonal polynomials</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="modelling-techniques.html"><a href="modelling-techniques.html#model-validation"><i class="fa fa-check"></i><b>5.5</b> Model validation</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="modelling-techniques.html"><a href="modelling-techniques.html#residuals"><i class="fa fa-check"></i><b>5.5.1</b> Residuals</a></li>
<li class="chapter" data-level="5.5.2" data-path="modelling-techniques.html"><a href="modelling-techniques.html#other-study-of-residuals"><i class="fa fa-check"></i><b>5.5.2</b> Other study of residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="modelling-techniques.html"><a href="modelling-techniques.html#proyecto---regresion-economistdata"><i class="fa fa-check"></i><b>5.6</b> Proyecto - regresion EconomistData</a></li>
<li class="chapter" data-level="5.7" data-path="modelling-techniques.html"><a href="modelling-techniques.html#proyecto---analysing-boston-dataset"><i class="fa fa-check"></i><b>5.7</b> Proyecto - Analysing <em>Boston</em> dataset</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="modelling-techniques.html"><a href="modelling-techniques.html#fit-a-simple-linear-regression"><i class="fa fa-check"></i><b>5.7.1</b> Fit a simple linear regression</a></li>
<li class="chapter" data-level="5.7.2" data-path="modelling-techniques.html"><a href="modelling-techniques.html#analyzing-the-model"><i class="fa fa-check"></i><b>5.7.2</b> Analyzing the model</a></li>
<li class="chapter" data-level="5.7.3" data-path="modelling-techniques.html"><a href="modelling-techniques.html#multiple-regression"><i class="fa fa-check"></i><b>5.7.3</b> Multiple regression</a></li>
<li class="chapter" data-level="5.7.4" data-path="modelling-techniques.html"><a href="modelling-techniques.html#interaction-terms"><i class="fa fa-check"></i><b>5.7.4</b> Interaction terms</a></li>
<li class="chapter" data-level="5.7.5" data-path="modelling-techniques.html"><a href="modelling-techniques.html#non-linear-transformations-of-the-predictors"><i class="fa fa-check"></i><b>5.7.5</b> Non-linear transformations of the predictors</a></li>
<li class="chapter" data-level="5.7.6" data-path="modelling-techniques.html"><a href="modelling-techniques.html#using-anova"><i class="fa fa-check"></i><b>5.7.6</b> Using anova</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="modelling-techniques.html"><a href="modelling-techniques.html#poyecto---evaluación-de-cursos---variables-categóricas"><i class="fa fa-check"></i><b>5.8</b> Poyecto - evaluación de cursos - variables categóricas</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="modelling-techniques.html"><a href="modelling-techniques.html#eda---exploratory-data-analysis"><i class="fa fa-check"></i><b>5.8.1</b> EDA - exploratory data analysis</a></li>
<li class="chapter" data-level="5.8.2" data-path="modelling-techniques.html"><a href="modelling-techniques.html#modelo-lineal"><i class="fa fa-check"></i><b>5.8.2</b> Modelo lineal</a></li>
<li class="chapter" data-level="5.8.3" data-path="modelling-techniques.html"><a href="modelling-techniques.html#interacción-de-modelos"><i class="fa fa-check"></i><b>5.8.3</b> Interacción de modelos</a></li>
<li class="chapter" data-level="5.8.4" data-path="modelling-techniques.html"><a href="modelling-techniques.html#multiple-regression-1"><i class="fa fa-check"></i><b>5.8.4</b> Multiple Regression</a></li>
<li class="chapter" data-level="5.8.5" data-path="modelling-techniques.html"><a href="modelling-techniques.html#validando-el-modelo"><i class="fa fa-check"></i><b>5.8.5</b> Validando el modelo</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="modelling-techniques.html"><a href="modelling-techniques.html#anexo-r-avanzado"><i class="fa fa-check"></i><b>5.9</b> Anexo: R avanzado</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="modelling-techniques.html"><a href="modelling-techniques.html#más-de-tidyverse"><i class="fa fa-check"></i><b>5.9.1</b> Más de tidyverse</a></li>
<li class="chapter" data-level="5.9.2" data-path="modelling-techniques.html"><a href="modelling-techniques.html#skimr-package"><i class="fa fa-check"></i><b>5.9.2</b> <code>Skimr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="modelling-techniques.html"><a href="modelling-techniques.html#proyecto---predicción-de-riesgos"><i class="fa fa-check"></i><b>5.10</b> Proyecto - Predicción de riesgos</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="series-temporales.html"><a href="series-temporales.html"><i class="fa fa-check"></i><b>6</b> Series Temporales</a>
<ul>
<li class="chapter" data-level="6.1" data-path="series-temporales.html"><a href="series-temporales.html#covid-predictions"><i class="fa fa-check"></i><b>6.1</b> COVID predictions</a></li>
<li class="chapter" data-level="6.2" data-path="series-temporales.html"><a href="series-temporales.html#introduction"><i class="fa fa-check"></i><b>6.2</b> Introduction</a></li>
<li class="chapter" data-level="6.3" data-path="series-temporales.html"><a href="series-temporales.html#time-series-analysis"><i class="fa fa-check"></i><b>6.3</b> Time series analysis</a></li>
<li class="chapter" data-level="6.4" data-path="series-temporales.html"><a href="series-temporales.html#time-series-in-r"><i class="fa fa-check"></i><b>6.4</b> Time Series in <code>R</code></a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="series-temporales.html"><a href="series-temporales.html#importing-time-series"><i class="fa fa-check"></i><b>6.4.1</b> Importing time series</a></li>
<li class="chapter" data-level="6.4.2" data-path="series-temporales.html"><a href="series-temporales.html#displaying-time-series"><i class="fa fa-check"></i><b>6.4.2</b> Displaying time series</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="series-temporales.html"><a href="series-temporales.html#time-series-components"><i class="fa fa-check"></i><b>6.5</b> Time Series Components</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="series-temporales.html"><a href="series-temporales.html#seasonal-plot"><i class="fa fa-check"></i><b>6.5.1</b> Seasonal plot</a></li>
<li class="chapter" data-level="6.5.2" data-path="series-temporales.html"><a href="series-temporales.html#subseries-plot"><i class="fa fa-check"></i><b>6.5.2</b> Subseries plot</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="series-temporales.html"><a href="series-temporales.html#other-packages"><i class="fa fa-check"></i><b>6.6</b> Other packages</a></li>
<li class="chapter" data-level="6.7" data-path="series-temporales.html"><a href="series-temporales.html#basic-forecasting-methods"><i class="fa fa-check"></i><b>6.7</b> Basic forecasting methods</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="series-temporales.html"><a href="series-temporales.html#average-method"><i class="fa fa-check"></i><b>6.7.1</b> Average method</a></li>
<li class="chapter" data-level="6.7.2" data-path="series-temporales.html"><a href="series-temporales.html#naïve-method"><i class="fa fa-check"></i><b>6.7.2</b> Naïve method</a></li>
<li class="chapter" data-level="6.7.3" data-path="series-temporales.html"><a href="series-temporales.html#seasonal-naïve-method"><i class="fa fa-check"></i><b>6.7.3</b> Seasonal naïve method</a></li>
<li class="chapter" data-level="6.7.4" data-path="series-temporales.html"><a href="series-temporales.html#drift-method"><i class="fa fa-check"></i><b>6.7.4</b> Drift method</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="series-temporales.html"><a href="series-temporales.html#example-temperature-forecast-in-malaga---basic-forecasting-methods"><i class="fa fa-check"></i><b>6.8</b> Example: Temperature forecast in Malaga - Basic forecasting methods</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="series-temporales.html"><a href="series-temporales.html#average-method-1"><i class="fa fa-check"></i><b>6.8.1</b> Average method</a></li>
<li class="chapter" data-level="6.8.2" data-path="series-temporales.html"><a href="series-temporales.html#naïve-method-1"><i class="fa fa-check"></i><b>6.8.2</b> Naïve method</a></li>
<li class="chapter" data-level="6.8.3" data-path="series-temporales.html"><a href="series-temporales.html#seasonal-naïve-method-1"><i class="fa fa-check"></i><b>6.8.3</b> Seasonal naïve method</a></li>
<li class="chapter" data-level="6.8.4" data-path="series-temporales.html"><a href="series-temporales.html#drift-method-1"><i class="fa fa-check"></i><b>6.8.4</b> Drift method</a></li>
<li class="chapter" data-level="6.8.5" data-path="series-temporales.html"><a href="series-temporales.html#conclusion"><i class="fa fa-check"></i><b>6.8.5</b> Conclusion</a></li>
<li class="chapter" data-level="6.8.6" data-path="series-temporales.html"><a href="series-temporales.html#decomposing-time-series"><i class="fa fa-check"></i><b>6.8.6</b> Decomposing Time Series</a></li>
<li class="chapter" data-level="6.8.7" data-path="series-temporales.html"><a href="series-temporales.html#additive-decomposition"><i class="fa fa-check"></i><b>6.8.7</b> Additive decomposition</a></li>
<li class="chapter" data-level="6.8.8" data-path="series-temporales.html"><a href="series-temporales.html#non-seasonal-data"><i class="fa fa-check"></i><b>6.8.8</b> Non-Seasonal Data</a></li>
<li class="chapter" data-level="6.8.9" data-path="series-temporales.html"><a href="series-temporales.html#seasonal-data"><i class="fa fa-check"></i><b>6.8.9</b> Seasonal Data</a></li>
<li class="chapter" data-level="6.8.10" data-path="series-temporales.html"><a href="series-temporales.html#seasonal-adjusting"><i class="fa fa-check"></i><b>6.8.10</b> Seasonal Adjusting</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="series-temporales.html"><a href="series-temporales.html#example-temperature-forecast-in-malaga---decomposing-time-series"><i class="fa fa-check"></i><b>6.9</b> Example: Temperature forecast in Malaga - Decomposing Time Series</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="series-temporales.html"><a href="series-temporales.html#additive-decomposition-1"><i class="fa fa-check"></i><b>6.9.1</b> Additive decomposition</a></li>
<li class="chapter" data-level="6.9.2" data-path="series-temporales.html"><a href="series-temporales.html#seasonal-adjusting-1"><i class="fa fa-check"></i><b>6.9.2</b> Seasonal Adjusting</a></li>
<li class="chapter" data-level="6.9.3" data-path="series-temporales.html"><a href="series-temporales.html#forecasts-using-exponential-smoothing"><i class="fa fa-check"></i><b>6.9.3</b> Forecasts using Exponential Smoothing</a></li>
<li class="chapter" data-level="6.9.4" data-path="series-temporales.html"><a href="series-temporales.html#simple-exponential-smoothing"><i class="fa fa-check"></i><b>6.9.4</b> Simple Exponential Smoothing</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="series-temporales.html"><a href="series-temporales.html#forecasting-using-forecast-package"><i class="fa fa-check"></i><b>6.10</b> Forecasting using forecast package</a></li>
<li class="chapter" data-level="6.11" data-path="series-temporales.html"><a href="series-temporales.html#example-temperature-forecast-in-malaga---exponential-smoothing"><i class="fa fa-check"></i><b>6.11</b> Example: Temperature forecast in Malaga - Exponential Smoothing</a>
<ul>
<li class="chapter" data-level="6.11.1" data-path="series-temporales.html"><a href="series-temporales.html#simple-exponential-smoothing-1"><i class="fa fa-check"></i><b>6.11.1</b> Simple Exponential Smoothing</a></li>
<li class="chapter" data-level="6.11.2" data-path="series-temporales.html"><a href="series-temporales.html#forecasting-using-forecast-package-1"><i class="fa fa-check"></i><b>6.11.2</b> Forecasting using forecast package</a></li>
</ul></li>
<li class="chapter" data-level="6.12" data-path="series-temporales.html"><a href="series-temporales.html#arima-methods"><i class="fa fa-check"></i><b>6.12</b> ARIMA methods</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="series-temporales.html"><a href="series-temporales.html#stationarity"><i class="fa fa-check"></i><b>6.12.1</b> Stationarity</a></li>
</ul></li>
<li class="chapter" data-level="6.13" data-path="series-temporales.html"><a href="series-temporales.html#autoregressive-models---arp"><i class="fa fa-check"></i><b>6.13</b> Autoregressive models - <strong>AR(p)</strong></a></li>
<li class="chapter" data-level="6.14" data-path="series-temporales.html"><a href="series-temporales.html#moving-average-models"><i class="fa fa-check"></i><b>6.14</b> Moving average models</a>
<ul>
<li class="chapter" data-level="6.14.1" data-path="series-temporales.html"><a href="series-temporales.html#differentiation"><i class="fa fa-check"></i><b>6.14.1</b> Differentiation</a></li>
<li class="chapter" data-level="6.14.2" data-path="series-temporales.html"><a href="series-temporales.html#second-order-differencing"><i class="fa fa-check"></i><b>6.14.2</b> Second order differencing</a></li>
</ul></li>
<li class="chapter" data-level="6.15" data-path="series-temporales.html"><a href="series-temporales.html#seasonal-differencing"><i class="fa fa-check"></i><b>6.15</b> Seasonal differencing</a>
<ul>
<li class="chapter" data-level="6.15.1" data-path="series-temporales.html"><a href="series-temporales.html#parameters-in-arima-methods."><i class="fa fa-check"></i><b>6.15.1</b> Parameters in ARIMA methods.</a></li>
</ul></li>
<li class="chapter" data-level="6.16" data-path="series-temporales.html"><a href="series-temporales.html#non-seasonal-arima-models"><i class="fa fa-check"></i><b>6.16</b> Non-seasonal ARIMA models</a></li>
<li class="chapter" data-level="6.17" data-path="series-temporales.html"><a href="series-temporales.html#auto-arima-model"><i class="fa fa-check"></i><b>6.17</b> Auto-ARIMA model</a></li>
<li class="chapter" data-level="6.18" data-path="series-temporales.html"><a href="series-temporales.html#example-temperature-forecast-in-malaga---modelos-arima"><i class="fa fa-check"></i><b>6.18</b> Example: Temperature forecast in Malaga - Modelos ARIMA</a></li>
<li class="chapter" data-level="6.19" data-path="series-temporales.html"><a href="series-temporales.html#references"><i class="fa fa-check"></i><b>6.19</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>7</b> Clustering</a>
<ul>
<li class="chapter" data-level="7.1" data-path="clustering.html"><a href="clustering.html#fundamentos"><i class="fa fa-check"></i><b>7.1</b> Fundamentos</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="clustering.html"><a href="clustering.html#medidas-de-similaridad"><i class="fa fa-check"></i><b>7.1.1</b> Medidas de similaridad</a></li>
<li class="chapter" data-level="7.1.2" data-path="clustering.html"><a href="clustering.html#disimilaridad-basada-en-diferencias"><i class="fa fa-check"></i><b>7.1.2</b> Disimilaridad basada en diferencias</a></li>
<li class="chapter" data-level="7.1.3" data-path="clustering.html"><a href="clustering.html#matriz-de-distancias"><i class="fa fa-check"></i><b>7.1.3</b> Matriz de distancias</a></li>
<li class="chapter" data-level="7.1.4" data-path="clustering.html"><a href="clustering.html#similaridad-basada-en-correlaciones"><i class="fa fa-check"></i><b>7.1.4</b> Similaridad basada en correlaciones</a></li>
<li class="chapter" data-level="7.1.5" data-path="clustering.html"><a href="clustering.html#correlación-de-pearson"><i class="fa fa-check"></i><b>7.1.5</b> Correlación de Pearson</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="clustering.html"><a href="clustering.html#clustering-en-r"><i class="fa fa-check"></i><b>7.2</b> Clustering en R</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="clustering.html"><a href="clustering.html#centros"><i class="fa fa-check"></i><b>7.2.1</b> Centros</a></li>
<li class="chapter" data-level="7.2.2" data-path="clustering.html"><a href="clustering.html#objetivo"><i class="fa fa-check"></i><b>7.2.2</b> Objetivo</a></li>
<li class="chapter" data-level="7.2.3" data-path="clustering.html"><a href="clustering.html#k-means"><i class="fa fa-check"></i><b>7.2.3</b> k-means</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="clustering.html"><a href="clustering.html#número-optimo-de-clusters"><i class="fa fa-check"></i><b>7.3</b> Número optimo de clusters</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="clustering.html"><a href="clustering.html#proyecto---dataset-usarrests"><i class="fa fa-check"></i><b>7.3.1</b> Proyecto - dataset USArrests</a></li>
<li class="chapter" data-level="7.3.2" data-path="clustering.html"><a href="clustering.html#tamaño-optimal-de-clusters"><i class="fa fa-check"></i><b>7.3.2</b> Tamaño optimal de clusters</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="clustering.html"><a href="clustering.html#clustering-jerárquico"><i class="fa fa-check"></i><b>7.4</b> Clustering jerárquico</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="clustering.html"><a href="clustering.html#proyecto-dataset-protein"><i class="fa fa-check"></i><b>7.4.1</b> Proyecto dataset protein</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="reglas-de-asociación.html"><a href="reglas-de-asociación.html"><i class="fa fa-check"></i><b>8</b> Reglas de Asociación</a>
<ul>
<li class="chapter" data-level="8.1" data-path="reglas-de-asociación.html"><a href="reglas-de-asociación.html#introducción-1"><i class="fa fa-check"></i><b>8.1</b> Introducción</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="reglas-de-asociación.html"><a href="reglas-de-asociación.html#detectando-y-prediciendo-tendencias"><i class="fa fa-check"></i><b>8.1.1</b> Detectando y prediciendo tendencias</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="reglas-de-asociación.html"><a href="reglas-de-asociación.html#reglas-de-asociación-de-transacciones"><i class="fa fa-check"></i><b>8.2</b> Reglas de Asociación de transacciones</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="reglas-de-asociación.html"><a href="reglas-de-asociación.html#parámetros-de-apriori"><i class="fa fa-check"></i><b>8.2.1</b> Parámetros de <strong>apriori</strong></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="reglas-de-asociación.html"><a href="reglas-de-asociación.html#reglas-de-asociación---preprocesamiento"><i class="fa fa-check"></i><b>8.3</b> Reglas de Asociación - preprocesamiento</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="reglas-de-asociación.html"><a href="reglas-de-asociación.html#discretización-de-items"><i class="fa fa-check"></i><b>8.3.1</b> Discretización de items</a></li>
<li class="chapter" data-level="8.3.2" data-path="reglas-de-asociación.html"><a href="reglas-de-asociación.html#tipo-de-dato-transactions"><i class="fa fa-check"></i><b>8.3.2</b> Tipo de dato <em>transactions</em></a></li>
<li class="chapter" data-level="8.3.3" data-path="reglas-de-asociación.html"><a href="reglas-de-asociación.html#métodos-de-arules"><i class="fa fa-check"></i><b>8.3.3</b> Métodos de arules</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="reglas-de-asociación.html"><a href="reglas-de-asociación.html#ejercicio-en-laboratorio"><i class="fa fa-check"></i><b>8.4</b> Ejercicio en Laboratorio</a></li>
<li class="chapter" data-level="8.5" data-path="reglas-de-asociación.html"><a href="reglas-de-asociación.html#arulesviz"><i class="fa fa-check"></i><b>8.5</b> arulesViz</a></li>
<li class="chapter" data-level="8.6" data-path="reglas-de-asociación.html"><a href="reglas-de-asociación.html#construyendo-un-sistema-recomendador"><i class="fa fa-check"></i><b>8.6</b> Construyendo un sistema recomendador</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html"><i class="fa fa-check"></i><b>9</b> Formal Concept Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#background-in-fca"><i class="fa fa-check"></i><b>9.1</b> Background in FCA</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#datasets"><i class="fa fa-check"></i><b>9.1.1</b> Datasets</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#working-with-formal-contexts---datasets"><i class="fa fa-check"></i><b>9.2</b> Working with Formal Contexts - datasets</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#plotting-printing-and-latex-ing-the-formalcontext"><i class="fa fa-check"></i><b>9.2.1</b> Plotting, printing and latex-ing the FormalContext</a></li>
<li class="chapter" data-level="9.2.2" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#closures"><i class="fa fa-check"></i><b>9.2.2</b> Closures</a></li>
<li class="chapter" data-level="9.2.3" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#clarification-and-reduction"><i class="fa fa-check"></i><b>9.2.3</b> Clarification and Reduction</a></li>
<li class="chapter" data-level="9.2.4" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#extracting-implications-and-concepts"><i class="fa fa-check"></i><b>9.2.4</b> Extracting Implications and Concepts</a></li>
<li class="chapter" data-level="9.2.5" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#saving-and-loading"><i class="fa fa-check"></i><b>9.2.5</b> Saving and loading</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#concept-lattice"><i class="fa fa-check"></i><b>9.3</b> Concept Lattice</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#plot-print-and-latex"><i class="fa fa-check"></i><b>9.3.1</b> Plot, print and LaTeX</a></li>
<li class="chapter" data-level="9.3.2" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#getting-all-extents-intents-and-retrieving-concepts"><i class="fa fa-check"></i><b>9.3.2</b> Getting all extents, intents and retrieving concepts</a></li>
<li class="chapter" data-level="9.3.3" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#concept-support"><i class="fa fa-check"></i><b>9.3.3</b> Concept support</a></li>
<li class="chapter" data-level="9.3.4" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#sublattices"><i class="fa fa-check"></i><b>9.3.4</b> Sublattices</a></li>
<li class="chapter" data-level="9.3.5" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#subconcepts-superconcepts-infimum-and-supremum"><i class="fa fa-check"></i><b>9.3.5</b> Subconcepts, superconcepts, infimum and supremum</a></li>
<li class="chapter" data-level="9.3.6" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#join--and-meet--irreducible-elements"><i class="fa fa-check"></i><b>9.3.6</b> Join- and meet- irreducible elements</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#exercises"><i class="fa fa-check"></i><b>9.4</b> Exercises</a></li>
<li class="chapter" data-level="9.5" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#implications-in-fca"><i class="fa fa-check"></i><b>9.5</b> Implications in FCA</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#crisp-version"><i class="fa fa-check"></i><b>9.5.1</b> Crisp Version</a></li>
<li class="chapter" data-level="9.5.2" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#computing-implications-and-concepts"><i class="fa fa-check"></i><b>9.5.2</b> Computing Implications and Concepts</a></li>
<li class="chapter" data-level="9.5.3" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#redudancy-removal"><i class="fa fa-check"></i><b>9.5.3</b> Redudancy Removal</a></li>
<li class="chapter" data-level="9.5.4" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#fuzzy-version"><i class="fa fa-check"></i><b>9.5.4</b> Fuzzy version</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#exercise"><i class="fa fa-check"></i><b>9.6</b> Exercise</a></li>
<li class="chapter" data-level="9.7" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#simplification-logic-for-mushroom-dataset"><i class="fa fa-check"></i><b>9.7</b> Simplification Logic for Mushroom Dataset”</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#data-1"><i class="fa fa-check"></i><b>9.7.1</b> Data</a></li>
<li class="chapter" data-level="9.7.2" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#preprocessing"><i class="fa fa-check"></i><b>9.7.2</b> Preprocessing</a></li>
<li class="chapter" data-level="9.7.3" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#importing-in-fcar"><i class="fa fa-check"></i><b>9.7.3</b> Importing in fcaR</a></li>
<li class="chapter" data-level="9.7.4" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#applying-rules"><i class="fa fa-check"></i><b>9.7.4</b> Applying Rules</a></li>
<li class="chapter" data-level="9.7.5" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#computing-closure"><i class="fa fa-check"></i><b>9.7.5</b> Computing Closure</a></li>
<li class="chapter" data-level="9.7.6" data-path="formal-concept-analysis.html"><a href="formal-concept-analysis.html#re-exporting-to-arules"><i class="fa fa-check"></i><b>9.7.6</b> Re-Exporting to <code>arules</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="social-network-analysis.html"><a href="social-network-analysis.html"><i class="fa fa-check"></i><b>10</b> Social Network Analysis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="social-network-analysis.html"><a href="social-network-analysis.html#r-for-sna"><i class="fa fa-check"></i><b>10.1</b> R for SNA</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="social-network-analysis.html"><a href="social-network-analysis.html#elementos-de-una-red"><i class="fa fa-check"></i><b>10.1.1</b> Elementos de una red</a></li>
<li class="chapter" data-level="10.1.2" data-path="social-network-analysis.html"><a href="social-network-analysis.html#representación-de-redes"><i class="fa fa-check"></i><b>10.1.2</b> Representación de redes</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="social-network-analysis.html"><a href="social-network-analysis.html#igraph"><i class="fa fa-check"></i><b>10.2</b> <code>igraph</code></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="social-network-analysis.html"><a href="social-network-analysis.html#acceder-a-elementos-de-grado"><i class="fa fa-check"></i><b>10.2.1</b> Acceder a elementos de grado</a></li>
<li class="chapter" data-level="10.2.2" data-path="social-network-analysis.html"><a href="social-network-analysis.html#construirmodificar-un-grafo"><i class="fa fa-check"></i><b>10.2.2</b> Construir/Modificar un grafo</a></li>
<li class="chapter" data-level="10.2.3" data-path="social-network-analysis.html"><a href="social-network-analysis.html#visualización-1"><i class="fa fa-check"></i><b>10.2.3</b> Visualización</a></li>
<li class="chapter" data-level="10.2.4" data-path="social-network-analysis.html"><a href="social-network-analysis.html#layout"><i class="fa fa-check"></i><b>10.2.4</b> Layout</a></li>
<li class="chapter" data-level="10.2.5" data-path="social-network-analysis.html"><a href="social-network-analysis.html#dibujar-grafos-ponderados"><i class="fa fa-check"></i><b>10.2.5</b> Dibujar grafos ponderados</a></li>
<li class="chapter" data-level="10.2.6" data-path="social-network-analysis.html"><a href="social-network-analysis.html#cambiar-aspecto-y-propiedades-de-un-grafo"><i class="fa fa-check"></i><b>10.2.6</b> Cambiar aspecto y propiedades de un grafo</a></li>
<li class="chapter" data-level="10.2.7" data-path="social-network-analysis.html"><a href="social-network-analysis.html#ejemplos---plantillas"><i class="fa fa-check"></i><b>10.2.7</b> Ejemplos - plantillas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="social-network-analysis.html"><a href="social-network-analysis.html#exportar-grafos"><i class="fa fa-check"></i><b>10.3</b> Exportar grafos</a></li>
<li class="chapter" data-level="10.4" data-path="social-network-analysis.html"><a href="social-network-analysis.html#de-twitter"><i class="fa fa-check"></i><b>10.4</b> De Twitter</a></li>
<li class="chapter" data-level="10.5" data-path="social-network-analysis.html"><a href="social-network-analysis.html#medidas-de-bondad-calidad"><i class="fa fa-check"></i><b>10.5</b> Medidas de bondad, calidad</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="social-network-analysis.html"><a href="social-network-analysis.html#centrality"><i class="fa fa-check"></i><b>10.5.1</b> Centrality</a></li>
<li class="chapter" data-level="10.5.2" data-path="social-network-analysis.html"><a href="social-network-analysis.html#degree"><i class="fa fa-check"></i><b>10.5.2</b> Degree</a></li>
<li class="chapter" data-level="10.5.3" data-path="social-network-analysis.html"><a href="social-network-analysis.html#betweenness"><i class="fa fa-check"></i><b>10.5.3</b> Betweenness</a></li>
<li class="chapter" data-level="10.5.4" data-path="social-network-analysis.html"><a href="social-network-analysis.html#edge_betweenness"><i class="fa fa-check"></i><b>10.5.4</b> Edge_betweenness</a></li>
<li class="chapter" data-level="10.5.5" data-path="social-network-analysis.html"><a href="social-network-analysis.html#closeness"><i class="fa fa-check"></i><b>10.5.5</b> Closeness</a></li>
<li class="chapter" data-level="10.5.6" data-path="social-network-analysis.html"><a href="social-network-analysis.html#eigenvector"><i class="fa fa-check"></i><b>10.5.6</b> Eigenvector</a></li>
<li class="chapter" data-level="10.5.7" data-path="social-network-analysis.html"><a href="social-network-analysis.html#pagerank"><i class="fa fa-check"></i><b>10.5.7</b> Pagerank</a></li>
<li class="chapter" data-level="10.5.8" data-path="social-network-analysis.html"><a href="social-network-analysis.html#diameter"><i class="fa fa-check"></i><b>10.5.8</b> Diameter</a></li>
<li class="chapter" data-level="10.5.9" data-path="social-network-analysis.html"><a href="social-network-analysis.html#caminos-y-distancias"><i class="fa fa-check"></i><b>10.5.9</b> Caminos y distancias</a></li>
<li class="chapter" data-level="10.5.10" data-path="social-network-analysis.html"><a href="social-network-analysis.html#transitivity"><i class="fa fa-check"></i><b>10.5.10</b> Transitivity</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="social-network-analysis.html"><a href="social-network-analysis.html#proyecto-sna---usairports"><i class="fa fa-check"></i><b>10.6</b> Proyecto SNA - USairports</a></li>
<li class="chapter" data-level="10.7" data-path="social-network-analysis.html"><a href="social-network-analysis.html#proyecto---películas-actores"><i class="fa fa-check"></i><b>10.7</b> Proyecto - películas + actores</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="social-network-analysis.html"><a href="social-network-analysis.html#crear-grafo"><i class="fa fa-check"></i><b>10.7.1</b> crear grafo</a></li>
<li class="chapter" data-level="10.7.2" data-path="social-network-analysis.html"><a href="social-network-analysis.html#análisis-del-grafo"><i class="fa fa-check"></i><b>10.7.2</b> Análisis del grafo</a></li>
<li class="chapter" data-level="10.7.3" data-path="social-network-analysis.html"><a href="social-network-analysis.html#cambiar-atributos-del-grafo"><i class="fa fa-check"></i><b>10.7.3</b> Cambiar atributos del grafo</a></li>
<li class="chapter" data-level="10.7.4" data-path="social-network-analysis.html"><a href="social-network-analysis.html#modificar-el-grafo"><i class="fa fa-check"></i><b>10.7.4</b> Modificar el grafo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pagerank-1.html"><a href="pagerank-1.html"><i class="fa fa-check"></i><b>11</b> pagerank</a></li>
<li class="chapter" data-level="12" data-path="análisis-de-componentes-principales.html"><a href="análisis-de-componentes-principales.html"><i class="fa fa-check"></i><b>12</b> Análisis de Componentes Principales</a></li>
<li class="chapter" data-level="13" data-path="text-imining.html"><a href="text-imining.html"><i class="fa fa-check"></i><b>13</b> Text Imining</a></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ciencia de Datos - UMA</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="series-temporales" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Capítulo 6</span> Series Temporales<a href="series-temporales.html#series-temporales" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="covid-predictions" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> COVID predictions<a href="series-temporales.html#covid-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p><a href="https://jamalrogersapp.shinyapps.io/tsforecast/">P A G T A G N A: Philippine COVID-19 Case Forecasting Web Application</a></p></li>
<li><p><a href="https://andrecalerovaldez.shinyapps.io/CovidTimeSeriesTest/">Andre Calero</a></p></li>
<li><p><a href="http://covid19forecast.science.unimelb.edu.au/?lang=es">covid19forecast</a></p></li>
</ul>
<p>Note: Install <strong>TTR</strong>, <strong>forecast</strong> packages</p>
</div>
<div id="introduction" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Introduction<a href="series-temporales.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Forecasting is one of the principal applications in data science.</p>
<p>See <a href="https://otexts.org/fpp2/">Forecasting: Principles and Practice</a></p>
<blockquote>
<p><strong>Tell us what the future holds, so we may know that you are gods.
(Isaiah 41:23)</strong></p>
</blockquote>
<p><strong>Forecasting is the set of techniques modelling how to predict the future as accurately as possible, given all of the information available, including historical data and any future data. These methods try to extrapolate trend and seasonal patterns</strong></p>
<p><strong>Applications of Forecasting</strong></p>
<ul>
<li>Medicine, epidemiology,</li>
<li>planning for the economy features of a country, financial institutions, pocily organizations,</li>
<li>weather, global temperature changes</li>
<li>scheduling in bussiness,</li>
<li>marketing,</li>
<li>predicting sales in a ship,</li>
<li>finance and risk management,</li>
<li>prediction of population in a country, in a region,</li>
<li>seismic recordings</li>
<li>planning th stock of product in a online shop,</li>
<li>deciding whether to build another power generation plant,</li>
<li>scheduling personal in a call centre depending of the number of calls,<br />
</li>
<li>deciding capital investments,</li>
</ul>
<p>See <a href="https://otexts.org/fpp2/perspective.html">The statistical forecasting perspective</a></p>
</div>
<div id="time-series-analysis" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Time series analysis<a href="series-temporales.html#time-series-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The study of adjacent points using conventional statistical methods have problems.</p>
<ul>
<li>Conventional statistical methods are dependent on the assumption that these adjacent
observations are independent and identically distributed.</li>
<li>The temporal data appears temporal correlations and ad-hoc techniques have been developed to treat these data.</li>
</ul>
<p><strong>Basic steps</strong></p>
<ul>
<li>Problem study</li>
<li>Data collection</li>
<li>Data analysis</li>
<li>Model selection and fitting</li>
<li>Model validation</li>
<li>Forecasting model deployment</li>
<li>Monitoring forecasting model performance</li>
</ul>
</div>
<div id="time-series-in-r" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Time Series in <code>R</code><a href="series-temporales.html#time-series-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="importing-time-series" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Importing time series<a href="series-temporales.html#importing-time-series" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To analyse your time series data we need to read it into R, and to plot the
time series.</p>
<p>You can read data into R using <strong>scan()</strong>, which assumes that your data for successive time
points is in a simple text file with one column.</p>
<!-- The file *kings.dat* contains data on the age of death of successive -->
<!-- kings of England, starting with William the Conqueror (original source: Hipel and Mcleod, 1994).  -->
<p>The file <em>ts_k1.dat</em> contains data about average business sales of a product.</p>
<p>[1] 60 43 67 50 56 42</p>
<p>The next step is to store the data in a time series object in R.</p>
<p><strong>A time series is a list of numbers with temporal information stored as a ts object in R</strong></p>
<p>There is a lot of packages and functions to deal with time series. Firstly, we will use <strong>ts</strong> function, which is used to create time-series objects.</p>
<p>See <a href="https://otexts.org/fpp2/ts-objects.html">ts-objects</a>.</p>
<p>Time Series:
Start = 1
End = 42
Frequency = 1
[1] 60 43 67 50 56 42 50 65 68 43 65 34 47 34 49 41 13 35 53 56 16 43 69 59 48
[26] 59 86 55 68 51 33 49 67 77 81 67 71 81 68 70 77 56</p>
<p>If the data set has values for periods less than
one year, for example, monthly or quarterly, one can specify the number of times that data was
collected per year by using the ‘frequency’ parameter in the <strong>ts</strong> function.</p>
<!-- For example, data set of the number of births per month in New York city, from January 1946 to December -->
<!-- 1959 (originally collected by Newton). -->
<p>Dataset of unemployment in a city:</p>
<pre><code>    Jan    Feb    Mar    Apr    May    Jun    Jul    Aug    Sep    Oct</code></pre>
<p>1980 26.663 23.598 26.931 24.740 25.806 24.364 24.477 23.901 23.175 23.227
1981 21.439 21.089 23.709 21.669 21.752 20.761 23.479 23.824 23.105 23.110
1982 21.937 20.035 23.590 21.672 22.222 22.123 23.950 23.504 22.238 23.142
1983 21.548 20.000 22.424 20.615 21.761 22.874 24.104 23.748 23.262 22.907
1984 22.604 20.894 24.677 23.673 25.320 23.583 24.671 24.454 24.122 24.252
1985 23.287 23.049 25.076 24.037 24.430 24.667 26.451 25.618 25.014 25.110
1986 23.798 22.270 24.775 22.646 23.988 24.737 26.276 25.816 25.210 25.199
1987 24.364 22.644 25.565 24.062 25.431 24.635 27.009 26.606 26.268 26.462
1988 24.657 23.304 26.982 26.199 27.210 26.122 26.706 26.878 26.152 26.379
1989 24.990 24.239 26.721 23.475 24.767 26.219 28.361 28.599 27.914 27.784
1990 26.217 24.218 27.914 26.975 28.527 27.139 28.982 28.169 28.056 29.136
1991 26.589 24.848 27.543 26.896 28.878 27.390 28.065 28.141 29.048 28.484
1992 27.132 24.924 28.963 26.589 27.931 28.009 29.229 28.759 28.405 27.945
1993 26.076 25.286 27.660 25.951 26.398 25.565 28.865 30.000 29.261 29.012
Nov Dec
1980 21.672 21.870
1981 21.759 22.073
1982 21.059 21.573
1983 21.519 22.025
1984 22.084 22.991
1985 22.964 23.981
1986 23.162 24.707
1987 25.246 25.180
1988 24.712 25.688
1989 25.693 26.881
1990 26.291 26.987
1991 26.634 27.735
1992 25.912 26.619
1993 26.992 27.897</p>
<!-- For instance, *fancy.dat* contains monthly sales for a souvenir shop at a -->
<!-- beach resort town in Queensland, Australia, for January 1987-December 1993 (original data from Wheelwright -->
<!-- and Hyndman, 1998).   -->
<p><strong>ts_f1.dat</strong> dataset contains monthly unemployment rates in a city.</p>
<pre><code>       Jan       Feb       Mar       Apr       May       Jun       Jul</code></pre>
<p>1987 1664.81 2397.53 2840.71 3547.29 3752.96 3714.74 4349.61
1988 2499.81 5198.24 7225.14 4806.03 5900.88 4951.34 6179.12
1989 4717.02 5702.63 9957.58 5304.78 6492.43 6630.80 7349.62
1990 5921.10 5814.58 12421.25 6369.77 7609.12 7224.75 8121.22
1991 4826.64 6470.23 9638.77 8821.17 8722.37 10209.48 11276.55
1992 7615.03 9849.69 14558.40 11587.33 9332.56 13082.09 16732.78
1993 10243.24 11266.88 21826.84 17357.33 15997.79 18601.53 26155.15
Aug Sep Oct Nov Dec
1987 3566.34 5021.82 6423.48 7600.60 19756.21
1988 4752.15 5496.43 5835.10 12600.08 28541.72
1989 8176.62 8573.17 9690.50 15151.84 34061.01
1990 7979.25 8093.06 8476.70 17914.66 30114.41
1991 12552.22 11637.39 13606.89 21822.11 45060.69
1992 19888.61 23933.38 25391.35 36024.80 80721.71
1993 28586.52 30505.41 30821.33 46634.38 104660.67</p>
</div>
<div id="displaying-time-series" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Displaying time series<a href="series-temporales.html#displaying-time-series" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let us make a basic plot of the time series data (for the two first datasets):</p>
<p><img src="_main_files/figure-html/unnamed-chunk-91-1.png" width="480" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-91-2.png" width="480" style="display: block; margin: auto;" /></p>
<p>In the second one, there seems to be seasonal variation in the number of unemployees per month: There is a peak every summer, and a trough every winter.</p>
<p>The plot for the third dataset is the following:
<img src="_main_files/figure-html/unnamed-chunk-92-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The size of
the seasonal fluctuations and random fluctuations seem to increase with the level of the time series. In these cases it is reasonable to transform the time series by calculating the natural logarithm of the original data.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-93-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>See <a href="https://otexts.org/fpp2/time-plots.html">time plots</a>.</p>
</div>
</div>
<div id="time-series-components" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Time Series Components<a href="series-temporales.html#time-series-components" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A time series has usually a trend component and an irregular component and, if it turns out to be a seasonal time series, a seasonal component as well.</p>
<p>See <a href="https://otexts.org/fpp2/tspatterns.html">Time series patterns: Trend, Seasonal, Cyclic</a>.</p>
<div id="seasonal-plot" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Seasonal plot<a href="series-temporales.html#seasonal-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="_main_files/figure-html/unnamed-chunk-94-1.png" width="480" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-94-2.png" width="480" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-94-3.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="subseries-plot" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Subseries plot<a href="series-temporales.html#subseries-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="_main_files/figure-html/unnamed-chunk-95-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The mean is indicated by horizontal lines.</p>
<p>See <a href="https://otexts.org/fpp2/graphics.html">Time series graphics: Scatterplots, lag plots, etc.</a>.</p>
</div>
</div>
<div id="other-packages" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Other packages<a href="series-temporales.html#other-packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>base R: times series class named ts. too restrictive, functiones associated limited</p></li>
<li><p>zoo, xts packages: to represent time series</p>
<ul>
<li><p>special structure for time series</p></li>
<li><p>many functions interestings</p></li>
</ul></li>
</ul>
<div class="warning" style="padding:1em; background-color:#CCCCCC; color:#404040">
<h3>
<strong>Exercise</strong>
</h3>
<ul>
<li><p>Make an .rmd with a mini-tutorial on the use of the zoo and xts packages, applying them to a time series (dataset with data from Spain) that you search on the web about electricity consumption, product consumption, etc.</p></li>
<li><p>Hand in the homework of the time series topic.</p></li>
</ul>
</div>
</div>
<div id="basic-forecasting-methods" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Basic forecasting methods<a href="series-temporales.html#basic-forecasting-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We denote <span class="math inline">\(\hat{y}_{T+h\mid T}\)</span> the value of the variable <span class="math inline">\(y\)</span> in the time <span class="math inline">\(T+h\)</span> based on <span class="math inline">\(y_1, \ldots, y_T\)</span>.</p>
<p>The residual will be computed by:</p>
<p><span class="math display">\[e_T=y_T-\hat{y}_{T}\]</span>
The forecast error is:
<span class="math display">\[e_t(T)=y_t-\hat{y}_{t}(t-T)\]</span></p>
<div id="average-method" class="section level3 hasAnchor" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Average method<a href="series-temporales.html#average-method" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[\hat{y}_{T+h\mid T}=\frac{(y_1, \ldots, y_T)}{T}\]</span></p>
<p><img src="_main_files/figure-html/unnamed-chunk-96-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="naïve-method" class="section level3 hasAnchor" number="6.7.2">
<h3><span class="header-section-number">6.7.2</span> Naïve method<a href="series-temporales.html#naïve-method" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The prediction will be the last <span class="math inline">\(Y_T\)</span>.</p>
<p><span class="math display">\[\hat{y}_{T+h\mid T}= y_T\]</span></p>
<p><img src="_main_files/figure-html/unnamed-chunk-97-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="seasonal-naïve-method" class="section level3 hasAnchor" number="6.7.3">
<h3><span class="header-section-number">6.7.3</span> Seasonal naïve method<a href="series-temporales.html#seasonal-naïve-method" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The prediction will be the same that the value of the variable in the last year in the same time.</p>
<p><span class="math display">\[\hat{y}_{T+h\mid T}= y_{T+h-m(k+1)}\]</span>
(where <span class="math inline">\(m\)</span> is the season in the year and <span class="math inline">\(k\)</span> is the truncated value of <span class="math inline">\((h-1)/m\)</span>)</p>
<p><img src="_main_files/figure-html/unnamed-chunk-98-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="drift-method" class="section level3 hasAnchor" number="6.7.4">
<h3><span class="header-section-number">6.7.4</span> Drift method<a href="series-temporales.html#drift-method" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is based on naïve method where the amount of change in time (the drift) is set as the average change in the historical data:</p>
<p><span class="math display">\[\hat{y}_{_{T+h\mid T}}=y_{_{T}}+\frac{h}{T-1}\displaystyle\sum_{t=2}^T(y_t-t_{t-1})=y_{_{T}}+h\frac{y_{_T}-y_{_{1}}}{T-1}\]</span></p>
<p><img src="_main_files/figure-html/unnamed-chunk-99-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>See all the methods in the same picture - <a href="https://otexts.org/fpp2/simple-methods.html#fig:beerf">Forecasts for quarterly beer production</a>.</p>
<p>Note: It is necessary the package <strong>fpp2</strong> to execute the code in this page.</p>
</div>
</div>
<div id="example-temperature-forecast-in-malaga---basic-forecasting-methods" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Example: Temperature forecast in Malaga - Basic forecasting methods<a href="series-temporales.html#example-temperature-forecast-in-malaga---basic-forecasting-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To analyse the evolution of minimum temperatures since 2001 in Malaga.</p>
<p>First of all we obtain a time-series object with the function <strong>ts</strong>, as our data are divided into months, we set the parameter <em>frecuency</em> to 12 and we indicate that we start in January 2001. After this, we draw the object obtained:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-101-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>We decompose the data: <em>Seasonal component</em>, <em>Trend component</em>, <em>Cycle component</em> y <em>residual</em>.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-102-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Let’s see if it is seasonal, let’s look at the data by year:
<img src="_main_files/figure-html/unnamed-chunk-103-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>As we can see, all the years are identical, which indicates that the temperatures repeat annual and monthly cycles.</p>
<p>With these graphs we can see that our series is seasonal, at the beginning of the year it is down, during the year it rises and from August onwards it starts to fall. This cycle is repeated every year.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-104-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>With this last graph we see the subseries by months. From it we see how each month moves in the same range. With this we confirm that it is a seasonal series.</p>
<div id="average-method-1" class="section level3 hasAnchor" number="6.8.1">
<h3><span class="header-section-number">6.8.1</span> Average method<a href="series-temporales.html#average-method-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With this method we see that the prediction is basically an average.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-105-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="naïve-method-1" class="section level3 hasAnchor" number="6.8.2">
<h3><span class="header-section-number">6.8.2</span> Naïve method<a href="series-temporales.html#naïve-method-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This method uses the last value of <span class="math inline">\(y_t\)</span>.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-106-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="seasonal-naïve-method-1" class="section level3 hasAnchor" number="6.8.3">
<h3><span class="header-section-number">6.8.3</span> Seasonal naïve method<a href="series-temporales.html#seasonal-naïve-method-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This method uses the last year to predict. As we will see in the graph, it generates what has happened in the last year.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-107-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="drift-method-1" class="section level3 hasAnchor" number="6.8.4">
<h3><span class="header-section-number">6.8.4</span> Drift method<a href="series-temporales.html#drift-method-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This method is based on the previous one and that the amount of change over time is set as the average change in the historical data.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-108-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="conclusion" class="section level3 hasAnchor" number="6.8.5">
<h3><span class="header-section-number">6.8.5</span> Conclusion<a href="series-temporales.html#conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>My data series as I have mentioned is for minimum temperatures, so these methods are too simple to predict well what will happen with the temperature in the following years. The only model that could be used is the <em>Seasonal naïve method</em> which uses the last year to see what will happen next year. But we still need to use better methods.</p>
</div>
<div id="decomposing-time-series" class="section level3 hasAnchor" number="6.8.6">
<h3><span class="header-section-number">6.8.6</span> Decomposing Time Series<a href="series-temporales.html#decomposing-time-series" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Decomposing a time series means separating it into its constituent components: trend, cycles, irregular, a seasonal component and a remainder component.</p>
<p>If <span class="math inline">\(S_t\)</span> is the seasonal component, <span class="math inline">\(T_t\)</span> is the trend-cycle component, and <span class="math inline">\(R_t\)</span> is the remainder component, we can consider an <strong>additive decomposition</strong> or a <strong>multiplicative decomposition</strong> as follows:</p>
<p>Additive decomposition:
<span class="math display">\[y_t=S_t+T_t+R_t\]</span>
Multiplicative decomposition:
<span class="math display">\[y_t=S_t\times T_t\times R_t\]</span></p>
<ul>
<li><p>Addditve decomposition is adequate when the seasonal part and the trend-cycle does not vary too much.</p></li>
<li><p>Multiplicative decomposition is adequate when the amplitude of the seasonal part increases or decreases with the average level of the time series.</p></li>
</ul>
<p>Multiplicative decomposition can be transformed into an additive one just by applying logarithms:
<span class="math display">\[\log y_t= \log S_t + \log T_t +\log R_t\]</span></p>
</div>
<div id="additive-decomposition" class="section level3 hasAnchor" number="6.8.7">
<h3><span class="header-section-number">6.8.7</span> Additive decomposition<a href="series-temporales.html#additive-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We describe how decompose a time series considering additive decomposition.</p>
<p><strong>Note: </strong>Multiplicative decomposition is similar, except that the subtractions are replaced by divisions.</p>
</div>
<div id="non-seasonal-data" class="section level3 hasAnchor" number="6.8.8">
<h3><span class="header-section-number">6.8.8</span> Non-Seasonal Data<a href="series-temporales.html#non-seasonal-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>A non-seasonal time series consists of a trend component and an irregular component.</p></li>
<li><p>To estimate the trend component of a non-seasonal time series that can be described using an <em>additive model</em>, it is
common to use a smoothing method, such as calculating the Simple Moving Average (SMA) of the time series.</p></li>
</ul>
<p>The <strong>SMA()</strong> function in the <strong><em>TTR</em></strong> package is used to smooth time series data using a simple moving average:</p>
<p><span class="math display">\[\hat{y_{_t}}=\frac{1}{m}\displaystyle\sum_{j=-k}^k y_{_{t+j}}\]</span></p>
<p>To compute the average eliminates randomness in the data.</p>
<p>To specify the order of the simple moving average, the parameter <span class="math inline">\(n\)</span> will be used. For example, to calculate a simple moving
average of order 2, we set <span class="math inline">\(n=2\)</span> in the SMA() function.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-109-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>There still appears to be quite a lot of random fluctuations in the time series smoothed using a simple moving
average of order 2.</p>
<p>Thus, to estimate the trend component more accurately, we might want to try smoothing the
data with a simple moving average of a higher order. This takes a little bit of trial-and-error, to find the right
amount of smoothing.</p>
<p>With MA of order 5, and order 9 the trend starts to be clearly identified in the plots.</p>
</div>
<div id="seasonal-data" class="section level3 hasAnchor" number="6.8.9">
<h3><span class="header-section-number">6.8.9</span> Seasonal Data<a href="series-temporales.html#seasonal-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A seasonal time series consists of a trend component, a seasonal component and an irregular component.</p>
<p>We can use the <strong>decompose</strong> function in R which estimates:</p>
<ul>
<li>the trend-cycle component using MA <span class="math inline">\(\hat{y_t}\)</span>,</li>
<li>the detrended serie <span class="math inline">\(y_t-\hat{y_t}\)</span></li>
<li>the seasonal component <span class="math inline">\(S_t\)</span>, computing the average of the detrended values for that season,<br />
</li>
<li>the random components <span class="math inline">\(R_t=y_t-\hat{y_t}-S_t\)</span>.</li>
</ul>
<p>To compute the detrended serie in additive decomposition: <span class="math inline">\(y_t-T_t =S_t+R_t\)</span></p>
<p>Given the time series <strong>ts.n1</strong>, we will decompose the time serie using the following:</p>
<!-- Given the time series  of the number of births per month in New York. -->
<p>The estimated seasonal factors are given for the months January-December, and are the same for each year.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-111-1.png" width="480" style="display: block; margin: auto;" />
<!--  We see that the -->
<!-- estimated trend component shows a small decrease from about 24 in 1947 to about 22 in 1948, followed by a -->
<!-- steady increase from then on to about 27 in 1959. --></p>
<!--  We see that the -->
<!-- estimated trend component shows a small decrease from about 24 in 1980 to about 22 in 1948, followed by a -->
<!-- steady increase from then on to about 27 in 1959. -->
<p>The different parts of the decomposed series can be managed as usual:</p>
</div>
<div id="seasonal-adjusting" class="section level3 hasAnchor" number="6.8.10">
<h3><span class="header-section-number">6.8.10</span> Seasonal Adjusting<a href="series-temporales.html#seasonal-adjusting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As we have explained, if you have a seasonal time series that can be described using an <em>additive model</em>, you can seasonally adjust the
time series by estimating the seasonal component, and subtracting the estimated seasonal component from the
original time series.</p>
<pre><code>      Jan      Feb      Mar      Apr      May      Jun      Jul      Aug</code></pre>
<p>1980 27.34019 25.68096 26.06848 25.54168 25.55435 24.51726 23.02095 22.73641
1981 22.11619 23.17196 22.84648 22.47068 21.50035 20.91426 22.02295 22.65941
1982 22.61419 22.11796 22.72748 22.47368 21.97035 22.27626 22.49395 22.33941
1983 22.22519 22.08296 21.56148 21.41668 21.50935 23.02726 22.64795 22.58341
1984 23.28119 22.97696 23.81448 24.47468 25.06835 23.73626 23.21495 23.28941
1985 23.96419 25.13196 24.21348 24.83868 24.17835 24.82026 24.99495 24.45341
1986 24.47519 24.35296 23.91248 23.44768 23.73635 24.89026 24.81995 24.65141
1987 25.04119 24.72696 24.70248 24.86368 25.17935 24.78826 25.55295 25.44141
1988 25.33419 25.38696 26.11948 27.00068 26.95835 26.27526 25.24995 25.71341
1989 25.66719 26.32196 25.85848 24.27668 24.51535 26.37226 26.90495 27.43441
1990 26.89419 26.30096 27.05148 27.77668 28.27535 27.29226 27.52595 27.00441
1991 27.26619 26.93096 26.68048 27.69768 28.62635 27.54326 26.60895 26.97641
1992 27.80919 27.00696 28.10048 27.39068 27.67935 28.16226 27.77295 27.59441
1993 26.75319 27.36896 26.79748 26.75268 26.14635 25.71826 27.40895 28.83541
Sep Oct Nov Dec
1980 22.48338 22.45176 22.78177 22.24682
1981 22.41338 22.33476 22.86877 22.44982
1982 21.54638 22.36676 22.16877 21.94982
1983 22.57038 22.13176 22.62877 22.40182
1984 23.43038 23.47676 23.19377 23.36782
1985 24.32238 24.33476 24.07377 24.35782
1986 24.51838 24.42376 24.27177 25.08382
1987 25.57638 25.68676 26.35577 25.55682
1988 25.46038 25.60376 25.82177 26.06482
1989 27.22238 27.00876 26.80277 27.25782
1990 27.36438 28.36076 27.40077 27.36382
1991 28.35638 27.70876 27.74377 28.11182
1992 27.71338 27.16976 27.02177 26.99582
1993 28.56938 28.23676 28.10177 28.27382
<img src="_main_files/figure-html/unnamed-chunk-113-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The seasonal variation has been removed from the seasonally adjusted time series. The seasonally
adjusted time series now just contains the trend component and an irregular component.</p>
</div>
</div>
<div id="example-temperature-forecast-in-malaga---decomposing-time-series" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Example: Temperature forecast in Malaga - Decomposing Time Series<a href="series-temporales.html#example-temperature-forecast-in-malaga---decomposing-time-series" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have seen that the time series we use is seasonal so we are going to use the method of
<em>Additive decomposition</em>.</p>
<div id="additive-decomposition-1" class="section level3 hasAnchor" number="6.9.1">
<h3><span class="header-section-number">6.9.1</span> Additive decomposition<a href="series-temporales.html#additive-decomposition-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A seasonal time series consists of a trend component, a seasonal component and an irregular component. To decompose it we are going to use <strong>decompose</strong>.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-114-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="seasonal-adjusting-1" class="section level3 hasAnchor" number="6.9.2">
<h3><span class="header-section-number">6.9.2</span> Seasonal Adjusting<a href="series-temporales.html#seasonal-adjusting-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we have a seasonal time series that can be described using an additive model, we can seasonally adjust the time series by estimating the seasonal component and subtracting the estimated seasonal component from the original time series.</p>
<pre><code>      Jan      Feb      Mar      Apr      May      Jun      Jul      Aug</code></pre>
<p>2001 15.21772 14.62312 16.29322 15.00204 13.99887 15.21996 13.84395 14.84199
2002 16.01772 15.02312 14.69322 13.70204 13.59887 14.21996 13.74395 13.04199
2003 14.01772 14.12312 15.39322 14.10204 14.89887 15.81996 14.34395 14.64199
2004 16.31772 15.32312 14.59322 13.20204 12.79887 14.71996 14.54395 14.44199
2005 12.51772 11.82312 14.29322 14.50204 15.29887 14.71996 15.34395 13.94199
2006 14.51772 17.42312 17.59322 16.30204 16.09887 14.61996 14.84395 14.04199
2007 13.31772 16.52312 14.19322 14.40204 14.89887 14.71996 14.74395 14.64199
2008 15.31772 17.12312 15.59322 14.70204 14.99887 14.61996 16.04395 15.84199
2009 13.91772 14.82312 14.49322 13.80204 15.34887 15.91996 16.04395 14.84199
2010 15.41772 15.92312 14.89322 15.40204 14.39887 14.51996 15.74395 15.94199
2011 15.71772 14.42312 15.09322 16.20204 15.79887 14.41996 14.34395 14.94199
2012 13.91772 11.82312 13.89322 14.60204 14.99887 16.41996 15.14395 15.84199
2013 16.11772 13.62312 14.89322 15.00204 13.99887 13.11996 13.54395 14.74199
2014 16.01772 15.42312 14.89322 16.60204 15.59887 15.31996 14.44395 14.94199
2015 14.86772 14.22312 15.09322 16.30204 16.19887 14.71996 16.74395 16.54199
2016 16.11772 15.92312 14.39322 15.60204 14.99887 15.01996 15.54395 15.74199
2017 14.21772 16.22312 14.79322 15.20204 15.19887 16.21996 14.84395 14.84199
2018 15.21772 13.82312 14.89322 14.10204 14.09887 14.41996 14.34395 15.34199
Sep Oct Nov Dec
2001 14.85424 14.82508 13.62900 14.95081
2002 13.85424 14.52508 16.72900 16.05081
2003 14.95424 14.42508 14.92900 14.25081
2004 14.25424 13.92508 13.82900 14.35081
2005 14.05424 14.62508 13.72900 15.05081
2006 14.55424 15.72508 16.52900 13.95081
2007 14.85424 14.82508 14.82900 15.35081
2008 14.95424 14.72508 12.82900 13.65081
2009 15.15424 15.82508 16.72900 15.65081
2010 15.25424 13.82508 14.52900 15.55081
2011 14.85424 14.42508 14.12900 14.05081
2012 15.05424 14.22508 15.62900 15.25081
2013 15.45424 16.12508 14.62900 14.75081
2014 16.05424 15.92508 16.32900 14.15081
2015 15.05424 15.52508 15.52900 16.35081
2016 15.35424 15.92508 14.72900 16.25081
2017 15.15424 14.22508 14.32900 13.95081
2018 16.55424 14.32508</p>
<p><img src="_main_files/figure-html/unnamed-chunk-116-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="forecasts-using-exponential-smoothing" class="section level3 hasAnchor" number="6.9.3">
<h3><span class="header-section-number">6.9.3</span> Forecasts using Exponential Smoothing<a href="series-temporales.html#forecasts-using-exponential-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Exponential Smoothing considers weigths to the values of the variables:
weighted averages of past observations. The weights decrease
exponentially for distant values.</p>
<p><a href="https://otexts.org/fpp2/taxonomy.html">Taxonomy</a></p>
</div>
<div id="simple-exponential-smoothing" class="section level3 hasAnchor" number="6.9.4">
<h3><span class="header-section-number">6.9.4</span> Simple Exponential Smoothing<a href="series-temporales.html#simple-exponential-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The idea is to consider a weighted average between the value of the
variable and the previous one:</p>
<p><span class="math display">\[\hat{y}_{T+1\mid T}=\alpha y_T + (1-\alpha)\hat{y}_{T\mid T-1}\]</span></p>
<p>If we have into account more past values of the variable, after some
computations, the forecast will be:</p>
<p><span class="math display">\[\hat{y}_{T+1\mid T}=\alpha y_T + \alpha(1-\alpha){y}_{T-1}+\alpha(1-\alpha)^2{y}_{T-2}+\ldots \]</span></p>
<p>The parameter <span class="math inline">\(\alpha\)</span> controls the rates at which the weights decrease.
The weights decrease exponentially and this is the reason of the name of
the method.</p>
<ul>
<li><p><span class="math inline">\(\alpha\)</span> has values between 0 and 1.</p></li>
<li><p><span class="math inline">\(\alpha\)</span> close to 0, more important are the longer observations -
 slow learning (past observations have a large influence on
forecasts).</p></li>
<li><p><span class="math inline">\(\alpha\)</span> close to 1, more important the more recent observation s-
fast learning (that is, only the most recent values influence the
forecasts).</p></li>
<li><p>With <span class="math inline">\(\alpha=0\)</span> or <span class="math inline">\(\alpha=1\)</span> we have the extreme cases.</p></li>
</ul>
<p>If you have a time series that can be described using an additive model
with constant level (no clear trend) and no seasonality, you can use
<strong>simple exponential smoothing</strong> to make short-term forecasts.</p>
<ul>
<li>The simple exponential smoothing method provides a way of estimating
the level at the current time point.</li>
</ul>
<p>The file <strong>ts_p1.dat</strong> contains total annual snowfall for a city.<br />
<!-- For instance, the file  **precip1.dat** contains total annual rainfall in inches for -->
<!-- London, from 1813-1912 (original data from Hipel and McLeod, 1994).   --></p>
<p><img src="_main_files/figure-html/unnamed-chunk-117-1.png" width="480" style="display: block; margin: auto;" /></p>
<ul>
<li>The mean stays constant at about 25 - roughly constant level.</li>
<li>The random fluctuations seem to be roughly constant.</li>
</ul>
<p>Thus, we can make forecasts using simple exponential smoothing.</p>
<p>In R, we can fit a simple exponential smoothing predictive model using
the <strong>HoltWinters</strong> function.</p>
<p><a href="https://docs.tibco.com/pub/enterprise-runtime-for-R/4.0.0/doc/html/Language_Reference/stats/HoltWinters.html">Main
parameters</a>:</p>
<ul>
<li>alpha: Smoothing is controlled by this parameter; the value of alpha
lies between 0 and 1 (close to 0 mean that little weight is placed
on the most recent observations when making forecasts of future
values).</li>
<li>beta=FALSE: the function will do exponential smoothing.</li>
<li>gamma=FALSE: a non-seasonal model is fitted.</li>
<li>seasonal: <strong>additive by default</strong> or multiplicative seasonal model.</li>
</ul>
<p>Holt-Winters exponential smoothing without trend and without seasonal component.</p>
<p>Call:
HoltWinters(x = ts.p1, beta = FALSE, gamma = FALSE)</p>
<p>Smoothing parameters:
alpha: 0.02412151
beta : FALSE
gamma: FALSE</p>
<p>Coefficients:
[,1]
a 24.67819</p>
<p>The output of <code>HoltWinters()</code> tells us that the estimated value of the
alpha parameter is about 0.024. This is very close to zero, telling us
that past observations have more influence on forecasts.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-120-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The plot shows the original time series in black, and the forecasts of
these values as a red line. The time series of forecasts is much
smoother than the time series of the original data here.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-121-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The function <code>forecast</code> predicts the value as the previous plot shows.</p>
<p>As a measure of the accuracy of the forecasts, we can calculate the sum
of squared errors for the in-sample forecast errors, that is, the
forecast errors for the time period covered by our original time series.
The sum-of-squared- errors is stored in a named element of the list
variable <code>ts.p1.forecasts</code> called “SSE”, so we can get its value by
typing:</p>
<p>[1] 1828.855</p>
<p>Finally, we try with different values of <span class="math inline">\(\alpha\)</span> and the errors are
computed:</p>
<p>Holt-Winters exponential smoothing without trend and without seasonal component.</p>
<p>Call:
HoltWinters(x = ts.p1, alpha = 0.5, beta = FALSE, gamma = FALSE)</p>
<p>Smoothing parameters:
alpha: 0.5
beta : FALSE
gamma: FALSE</p>
<p>Coefficients:
[,1]
a 26.45644
<img src="_main_files/figure-html/unnamed-chunk-123-1.png" width="480" style="display: block; margin: auto;" />[1] 2428.339
Holt-Winters exponential smoothing without trend and without seasonal component.</p>
<p>Call:
HoltWinters(x = ts.p1, alpha = 0.9, beta = FALSE, gamma = FALSE)</p>
<p>Smoothing parameters:
alpha: 0.9
beta : FALSE
gamma: FALSE</p>
<p>Coefficients:
[,1]
a 27.57778
<img src="_main_files/figure-html/unnamed-chunk-123-2.png" width="480" style="display: block; margin: auto;" />[1] 3399.419</p>
<p>Note: The forecasts made by <code>HoltWinters</code> are stored in the list called
fitted.</p>
<p>Time Series:
Start = 1901
End = 1999
Frequency = 1
xhat level
1901 23.56000 23.56000
1902 25.81900 25.81900
1903 22.25590 22.25590
1904 30.34159 30.34159
1905 24.31916 24.31916
1906 23.92392 23.92392
1907 26.16139 26.16139
1908 23.01914 23.01914
1909 30.82291 30.82291
1910 24.55629 24.55629
1911 24.15463 24.15463
1912 31.60246 31.60246
1913 24.09425 24.09425
1914 22.72242 22.72242
1915 22.97224 22.97224
1916 27.38922 27.38922
1917 25.52692 25.52692
1918 25.12469 25.12469
1919 27.49647 27.49647
1920 20.58765 20.58765
1921 24.36076 24.36076
1922 20.54408 20.54408
1923 23.96041 23.96041
1924 27.07404 27.07404
1925 20.20340 20.20340
1926 21.48734 21.48734
1927 26.88973 26.88973
1928 20.17597 20.17597
1929 30.03460 30.03460
1930 23.78446 23.78446
1931 25.64345 25.64345
1932 22.94934 22.94934
1933 22.76993 22.76993
1934 26.00099 26.00099
1935 18.53010 18.53010
1936 28.68201 28.68201
1937 23.50520 23.50520
1938 19.64852 19.64852
1939 20.53185 20.53185
1940 33.85919 33.85919
1941 26.68692 26.68692
1942 19.45369 19.45369
1943 22.69937 22.69937
1944 22.25894 22.25894
1945 22.18789 22.18789
1946 19.11179 19.11179
1947 27.30018 27.30018
1948 31.74602 31.74602
1949 23.21760 23.21760
1950 27.13476 27.13476
1951 22.14448 22.14448
1952 17.45145 17.45145
1953 28.27714 28.27714
1954 31.26771 31.26771
1955 26.75177 26.75177
1956 23.73518 23.73518
1957 25.25152 25.25152
1958 21.71315 21.71315
1959 24.68932 24.68932
1960 32.94293 32.94293
1961 23.69729 23.69729
1962 19.30773 19.30773
1963 27.52677 27.52677
1964 26.29668 26.29668
1965 27.98267 27.98267
1966 33.47027 33.47027
1967 33.78503 33.78503
1968 30.63050 30.63050
1969 28.19105 28.19105
1970 27.24511 27.24511
1971 24.68451 24.68451
1972 20.78345 20.78345
1973 26.05435 26.05435
1974 26.91443 26.91443
1975 19.98044 19.98044
1976 26.96404 26.96404
1977 24.16140 24.16140
1978 21.52314 21.52314
1979 27.48731 27.48731
1980 23.09773 23.09773
1981 20.12977 20.12977
1982 27.15898 27.15898
1983 22.03890 22.03890
1984 23.37189 23.37189
1985 22.91119 22.91119
1986 18.21212 18.21212
1987 22.10721 22.10721
1988 23.16272 23.16272
1989 22.26927 22.26927
1990 20.98293 20.98293
1991 36.38829 36.38829
1992 22.22383 22.22383
1993 22.89538 22.89538
1994 24.12354 24.12354
1995 23.12135 23.12135
1996 23.61514 23.61514
1997 26.43651 26.43651
1998 25.46765 25.46765
1999 24.85777 24.85777</p>
</div>
</div>
<div id="forecasting-using-forecast-package" class="section level2 hasAnchor" number="6.10">
<h2><span class="header-section-number">6.10</span> Forecasting using forecast package<a href="series-temporales.html#forecasting-using-forecast-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can make forecasts for further time points by using the
<code>forecast.HoltWinters</code> function in the R <code>forecast</code> package.</p>
<p>When using the <code>forecast.HoltWinters</code> function, as its first argument
(input), you pass it the predictive model that you have already fitted
using the <code>HoltWinters</code> function.</p>
<p>You specify how many further time points you want to make forecasts for
by using the “h” parameter in <code>forecast.HoltWinters()</code>.</p>
<p>The output for the next 20 years is:</p>
<pre><code> Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95</code></pre>
<p>2000 24.67819 19.17493 30.18145 16.26169 33.09470
2001 24.67819 19.17333 30.18305 16.25924 33.09715
2002 24.67819 19.17173 30.18465 16.25679 33.09960
2003 24.67819 19.17013 30.18625 16.25434 33.10204
2004 24.67819 19.16853 30.18785 16.25190 33.10449
2005 24.67819 19.16694 30.18945 16.24945 33.10694
2006 24.67819 19.16534 30.19105 16.24701 33.10938
2007 24.67819 19.16374 30.19265 16.24456 33.11182
2008 24.67819 19.16214 30.19425 16.24212 33.11427
2009 24.67819 19.16054 30.19584 16.23968 33.11671
2010 24.67819 19.15895 30.19744 16.23724 33.11915
2011 24.67819 19.15735 30.19904 16.23479 33.12159
2012 24.67819 19.15576 30.20063 16.23235 33.12403
2013 24.67819 19.15416 30.20223 16.22991 33.12647
2014 24.67819 19.15257 30.20382 16.22748 33.12891
2015 24.67819 19.15097 30.20542 16.22504 33.13135
2016 24.67819 19.14938 30.20701 16.22260 33.13379
2017 24.67819 19.14778 30.20860 16.22016 33.13623
2018 24.67819 19.14619 30.21020 16.21773 33.13866
2019 24.67819 19.14460 30.21179 16.21529 33.14110</p>
<p>The forecast for a year, a 80% prediction interval for the forecast, and
a 95% prediction interval for the forecast.</p>
<!-- Columns: -->
<!-- - Point: the yearThe forecasted snowfall for 2008 is about 24.68, -->
<!-- with a 95% prediction interval of (16.24, 33.11).  -->
<p>Plotting the predictions:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-127-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The forecasts for 2000-2020 are plotted as a blue line, the 80%
prediction interval as a dark blue shaded area, and the 95% prediction
interval as a grey shaded area.</p>
<p><strong>Forecast errors</strong></p>
<p>Forecast errors are stored in the element <em>residuals</em>.</p>
<ul>
<li>If the predictive model cannot be improved upon, there should be no
correlations between forecast errors for successive predictions.</li>
<li>If there are correlations between forecast errors for successive
predictions, it is likely that the simple exponential smoothing
forecasts could be improved upon by another forecasting technique.</li>
</ul>
<p>To figure out whether this is the case, we can obtain a correlogram of
the in-sample forecast errors. We can calculate a correlogram of the
forecast errors using the <code>acf</code> function in R.</p>
<p><code>acf</code> computes (and plots, by default) the estimation of the
autocovariance or AutoCorrelation Function (ACF).</p>
<p><img src="_main_files/figure-html/unnamed-chunk-128-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The autocorrelation at lag 3 is just touching the significance bounds
(significant evidence for non-zero correlations).</p>
<p>To test whether there is significant evidence for non-zero correlations
at lags, we can carry out a Ljung- Box test. This can be done in R using
the <strong>Box.test</strong> function.</p>
<pre><code>Box-Ljung test</code></pre>
<p>data: ts.p1.forecasts2$residuals
X-squared = 17.401, df = 20, p-value = 0.6268</p>
<p>The p-value is 0.6, so there is little evidence of non-zero
autocorrelations in the in-sample forecast errors at lags 1-20.</p>
<!-- To check whether the forecast errors have -->
<!-- constant variance, we can make a time plot of the in-sample forecast errors: -->
<!-- ```{r} -->
<!-- plot.ts(ts.p1.forecasts2$residuals) -->
<!-- ``` -->
<!-- # others  -->
<!--  We will use the R **stats** package for  manipulating and plotting time series, and for calculating the -->
<!-- autocorrelation function. -->
<!-- - The function **stl()** decomposes a times series into a trend and seasonal components, etc. -->
<!-- - The functions **ar()** (for “autoregressive” models) and associated functions, and **arima0()** ( “autoregressive integrated moving average models”) fit standard types of time domain short memory models.  -->
<!-- - The function **spectrum()** and related functions are designed for frequency domain or “spectral” analysis. -->
<!-- -  The function **acf()** to plot the autocorrelation function -->
<!-- The function **gls()** in the -->
<!-- **nlme** package, which can fit relatively complex models that may have autoregressive, arima and various other -->
<!-- types of dependence structure. -->
</div>
<div id="example-temperature-forecast-in-malaga---exponential-smoothing" class="section level2 hasAnchor" number="6.11">
<h2><span class="header-section-number">6.11</span> Example: Temperature forecast in Malaga - Exponential Smoothing<a href="series-temporales.html#example-temperature-forecast-in-malaga---exponential-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Analyse the evolution of minimum temperatures since 2001 in Malaga <strong>with the methods seen in this document. Malaga </strong>with the methods seen in this document**.</p>
<p>We obtain a time-series object with the <code>ts</code> function. data are divided into months, the parameter <em>frequency</em> is set to 12 and we indicate that we start in January 2001. After this, we draw the object:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-131-1.png" width="480" style="display: block; margin: auto;" /></p>
<p><strong>Forecasts using Exponential Smoothing</strong></p>
<p><em>Exponential Smoothing</em> considers weights on variable values: weighted averages of past observations. The weights decrease exponentially for distant values.</p>
<div id="simple-exponential-smoothing-1" class="section level3 hasAnchor" number="6.11.1">
<h3><span class="header-section-number">6.11.1</span> Simple Exponential Smoothing<a href="series-temporales.html#simple-exponential-smoothing-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>alpha parameter of Holt-Winters Filter.</li>
<li>beta parameter of Holt-Winters Filter. If set to FALSE, the function
will do exponential smoothing.</li>
<li>gamma parameter used for the seasonal component. If set to FALSE, an
non-seasonal model is fitted.</li>
</ul>
<p>Looking at these parameters we have to assemble a model with <em>beta=FALSE</em> as we want exponential smoothing.</p>
<p>Holt-Winters exponential smoothing without trend and with additive seasonal component.</p>
<p>Call:
HoltWinters(x = ts.p1, beta = FALSE)</p>
<p>Smoothing parameters:
alpha: 0.1412013
beta : FALSE
gamma: 0.2045694</p>
<p>Coefficients:
[,1]
a 14.8002193
s1 -3.0179721
s2 -5.3483612
s3 -6.0676567
s4 -5.8300885
s5 -4.2971166
s6 -2.0597869
s7 0.5443399
s8 4.3512303
s9 6.9081866
s10 7.9327353
s11 5.3361482
s12 1.4610327</p>
<p><img src="_main_files/figure-html/unnamed-chunk-133-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The graph shows the original time series in black, and forecasts of these values as a red line. The forecast time series is very close to the original data.</p>
<p>We now draw the forecast using <code>forecast</code>.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-134-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>As we can see it fits quite well with what is happening in recent years.</p>
<p>Let’s try a higher <em>alpha</em> value:</p>
<p>Holt-Winters exponential smoothing without trend and with additive seasonal component.</p>
<p>Call:
HoltWinters(x = ts.p1, alpha = 0.5, beta = FALSE)</p>
<p>Smoothing parameters:
alpha: 0.5
beta : FALSE
gamma: 0.3927417</p>
<p>Coefficients:
[,1]
a 15.0512589
s1 -3.1697282
s2 -5.4838631
s3 -6.2075694
s4 -5.9219038
s5 -4.2667725
s6 -1.8548302
s7 0.8149946
s8 4.5957651
s9 7.0279317
s10 8.0279557
s11 5.3161216
s12 1.1929326</p>
<p><img src="_main_files/figure-html/unnamed-chunk-136-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Holt-Winters exponential smoothing without trend and with additive seasonal component.</p>
<p>Call:
HoltWinters(x = ts.p1, alpha = 0.9, beta = FALSE)</p>
<p>Smoothing parameters:
alpha: 0.9
beta : FALSE
gamma: 0.9999496</p>
<p>Coefficients:
[,1]
a 14.7654331
s1 -3.0613814
s2 -5.3688209
s3 -5.8712039
s4 -5.2291009
s5 -3.4451379
s6 -1.4794315
s7 0.5904564
s8 4.0760361
s9 6.5257969
s10 7.4170932
s11 4.6994542
s12 1.1345783</p>
<p><img src="_main_files/figure-html/unnamed-chunk-138-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>As we can see there is not much difference between the first model and the other 2 created later, so the <em>alpha</em> value generated by the first model is the optimal one. We can see that the higher the <em>alpha</em> value, the narrower the fixed values, and the <em>gamma</em> values increase along with <em>alpha</em>.</p>
</div>
<div id="forecasting-using-forecast-package-1" class="section level3 hasAnchor" number="6.11.2">
<h3><span class="header-section-number">6.11.2</span> Forecasting using forecast package<a href="series-temporales.html#forecasting-using-forecast-package-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we use the <em><code>forecast.HoltWinters</code></em> function, as the first argument, it is passed the predictive model that we have already set using the <code>HoltWinters</code> function.</p>
<p>To specify how many additional time points we want to predict, we use the parameter <em>“h”</em>.</p>
<p>The prediction for the next 2 years is:</p>
<pre><code>     Point Forecast     Lo 80    Hi 80     Lo 95    Hi 95</code></pre>
<p>Nov 2018 11.782247 10.448881 13.11561 9.743039 13.82146
Dec 2018 9.451858 8.105265 10.79845 7.392421 11.51129
Jan 2019 8.732563 7.372871 10.09225 6.653094 10.81203
Feb 2019 8.970131 7.597467 10.34279 6.870822 11.06944
Mar 2019 10.503103 9.117587 11.88862 8.384139 12.62207
Apr 2019 12.740432 11.342183 14.13868 10.601995 14.87887
May 2019 15.344559 13.933692 16.75543 13.186823 17.50229
Jun 2019 19.151450 17.728075 20.57482 16.974587 21.32831
Jul 2019 21.708406 20.272634 23.14418 19.512582 23.90423
Aug 2019 22.732955 21.284891 24.18102 20.518333 24.94758
Sep 2019 20.136368 18.676116 21.59662 17.903106 22.36963
Oct 2019 16.261252 14.788913 17.73359 14.009504 18.51300
Nov 2019 11.782247 10.250481 13.31401 9.439613 14.12488
Dec 2019 9.451858 7.908565 10.99515 7.091594 11.81212
Jan 2020 8.732563 7.177827 10.28730 6.354800 11.11032
Feb 2020 8.970131 7.404038 10.53622 6.574998 11.36526
Mar 2020 10.503103 8.925733 12.08047 8.090724 12.91548
Apr 2020 12.740432 11.151866 14.32900 10.310930 15.16993
May 2020 15.344559 13.744875 16.94424 12.898054 17.79106
Jun 2020 19.151450 17.540725 20.76217 16.688058 21.61484
Jul 2020 21.708406 20.086715 23.33010 19.228243 24.18857
Aug 2020 22.732955 21.100371 24.36554 20.236134 25.22978
Sep 2020 20.136368 18.492964 21.77977 17.622999 22.64974
Oct 2020 16.261252 14.607099 17.91541 13.731443 18.79106</p>
<p><img src="_main_files/figure-html/unnamed-chunk-140-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The forecasts for the next 2 years are represented as a blue line, the 80% prediction interval as a dark grey shaded area and the 95% prediction interval as a grey shaded area.</p>
<p><strong>Forecast errors</strong></p>
<p>Errors are stored in <code>residuals</code>.</p>
<ul>
<li>If the model cannot be improved, there should be no correlations between forecast errors for successive predictions.</li>
<li>If there are correlations between forecast errors for successive predictions, it is likely that the predictions can be improved with another technique.</li>
</ul>
<p>To find out which is the case, we can obtain a correlation of the errors. We can calculate it using the <code>acf</code> function. <code>acf</code> calculates the estimate of the autocovariance or autocorrelation function <em>(ACF)</em>.</p>
<p>Let’s see what happens, we use <code>acf</code> with residuals and lag max 24.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-141-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>We performed a Ljung Box text to see if there is significant evidence of non-zero correlations in the <strong>lag</strong>.</p>
<pre><code>Box-Ljung test</code></pre>
<p>data: ts.p1.forecasts2$residuals
X-squared = 41.723, df = 24, p-value = 0.01386</p>
<p>As we can see, the p-value is 0.01, which tells us that there is evidence of autocorrelations other than 0.</p>
<p>Note: The ACF (AutoCorrelation Function) chart is used to identify non-stationary time series. Stationary: if the ACF is rapidly declining</p>
</div>
</div>
<div id="arima-methods" class="section level2 hasAnchor" number="6.12">
<h2><span class="header-section-number">6.12</span> ARIMA methods<a href="series-temporales.html#arima-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The difference between exponential smoothing models and ARIMA models is that the former are based on a description of the trend and seasonality of the data, while <strong>ARIMA models study the autocorrelations of the data.</strong></p>
<p>As we have already seen, the name ARIMA comes from <em>AutoRegressive Integrated Moving Average</em>.</p>
<ul>
<li><p><strong><em>AR</em></strong>: the study variable is analysed using the above values (<em>lag</em>).</p></li>
<li><p><strong>MA</strong>: the regression error is a linear combination of current and past values of the signal.</p></li>
<li><p><strong><em>I</em></strong>: replaces the value of the variable by the difference between the values and the previous values (one or more times).</p></li>
</ul>
<p>ARIMA models can be obtained following the <strong>Box-Jenkins</strong> method.</p>
<div id="stationarity" class="section level3 hasAnchor" number="6.12.1">
<h3><span class="header-section-number">6.12.1</span> Stationarity<a href="series-temporales.html#stationarity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A time series is said to be stationary when it does not depend on the instant of observation (white noise series).</p>
<p>The autocovariance function is defined as
<span class="math display">\[Cov(y_t,y_{t+k}) = \gamma(k), \forall k\]</span></p>
<p>That is, the covariance does not depend on time, only on the parameter <span class="math inline">\(k\)</span> (lag).</p>
<ul>
<li><p>If a series has a trend or stationarity it is not stationary.</p></li>
<li><p>A time series that has a cyclical component is stationary.</p></li>
</ul>
</div>
</div>
<div id="autoregressive-models---arp" class="section level2 hasAnchor" number="6.13">
<h2><span class="header-section-number">6.13</span> Autoregressive models - <strong>AR(p)</strong><a href="series-temporales.html#autoregressive-models---arp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The current value of the <span class="math inline">\(x_t\)</span> series can be explained as a function of <span class="math inline">\(p\)</span> past values, <span class="math inline">\(x_{t-1},x_{t-2},x_{t-p}\)</span>, where <span class="math inline">\(p\)</span> determines the number of past steps needed for the prediction.</p>
<p><span class="math display">\[
y_t=c+\phi_1y_{t-1}+\phi_2y_{t-2}+\cdots+\phi_py_{t-p}+\epsilon_t
\]</span></p>
<ul>
<li><span class="math inline">\(\epsilon_t\)</span>: Gaussian white noise with mean 0 and variance <span class="math inline">\(sigma^2_epsilon\)</span>.</li>
<li>If the mean is non-zero, <span class="math inline">\(c\)</span> takes the value <span class="math inline">\(c = \mu(1-\phi_1-\cdots-\phi_p)\)</span>.</li>
</ul>
<p>This is an autoregressive model of order <span class="math inline">\(p\)</span> that applies to stationary models.</p>
</div>
<div id="moving-average-models" class="section level2 hasAnchor" number="6.14">
<h2><span class="header-section-number">6.14</span> Moving average models<a href="series-temporales.html#moving-average-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As an alternative to the autoregressive representation where <span class="math inline">\(x_t\)</span> (on the left-hand side of the equation) are assumed to be linear combinations using moving averages of order <span class="math inline">\(q\)</span>, <span class="math inline">\(MA(q)\)</span>. We assume white noise <span class="math inline">\(epsilon_t\)</span>. Model MA(<span class="math inline">\(q\)</span>):</p>
<p><span class="math display">\[
y_t=c+\epsilon_t+\theta_1\epsilon_{t-1}+\theta_2\epsilon_{t-2}+\cdots+\theta_q\epsilon_{t-q}
\]</span></p>
<p>As with autoregressive models, changing the parameters affects the time series patterns and changing the error term changes the scale.</p>
<div id="differentiation" class="section level3 hasAnchor" number="6.14.1">
<h3><span class="header-section-number">6.14.1</span> Differentiation<a href="series-temporales.html#differentiation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To convert a non-stationary time series into a stationary time series, the differences between consecutive signal values are calculated (trend and seasonality are removed or reduced).</p>
<p>The following equation allows to calculate the differences between consecutive signal values:</p>
<p><span class="math display">\[
y&#39;_t=y_t-y_{t-1}
\]</span></p>
<p>If the differentiated series is white noise:</p>
<p><span class="math display">\[
y_t-y_{t-1}=\epsilon_t
\]</span> (<span class="math inline">\(\epsilon_t\)</span> denotes white noise)</p>
<p>A closely related model allows the difference to have a non-zero mean.
<span class="math display">\[
y_t-y_{t-1}=c+\epsilon_t
\]</span>
where <span class="math inline">\(c\)</span> is the average of the changes between consecutive observations.</p>
</div>
<div id="second-order-differencing" class="section level3 hasAnchor" number="6.14.2">
<h3><span class="header-section-number">6.14.2</span> Second order differencing<a href="series-temporales.html#second-order-differencing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The difference of the data may have to be recalculated a second time to obtain a stationary series (the change in changes).</p>
</div>
</div>
<div id="seasonal-differencing" class="section level2 hasAnchor" number="6.15">
<h2><span class="header-section-number">6.15</span> Seasonal differencing<a href="series-temporales.html#seasonal-differencing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A seasonal difference is the difference between one observation and the previous observation:
<span class="math display">\[
y&#39;_{_t}=y_{_t}-y_{_{t-m}}
\]</span>
where <span class="math inline">\(m\)</span> is the number of seasons.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="series-temporales.html#cb11-1" tabindex="-1"></a>lynx <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;data/annual-number-of-lynx-trapped-ma.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="st">&#39;</span><span class="sc">\&quot;</span><span class="st">&#39;</span>)</span>
<span id="cb11-2"><a href="series-temporales.html#cb11-2" tabindex="-1"></a>lynx.ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(lynx<span class="sc">$</span>Lynx, <span class="at">frequency =</span> <span class="dv">1</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1821</span>))</span>
<span id="cb11-3"><a href="series-temporales.html#cb11-3" tabindex="-1"></a>electricity <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;data/monthly-electricity-production-i.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="st">&#39;</span><span class="sc">\&quot;</span><span class="st">&#39;</span>)</span>
<span id="cb11-4"><a href="series-temporales.html#cb11-4" tabindex="-1"></a>electricity.ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(electricity<span class="sc">$</span>Million.kilowatt.hours, <span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1956</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="series-temporales.html#cb12-1" tabindex="-1"></a></span>
<span id="cb12-2"><a href="series-temporales.html#cb12-2" tabindex="-1"></a><span class="fu">plot.ts</span>(lynx.ts, <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Lynx Trapped&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-144"></span>
<img src="_main_files/figure-html/unnamed-chunk-144-1.png" alt="\label{fig:cyclic}Although there are cycles, they are not fixed in time." width="480" />
<p class="caption">
Figure 6.1: Although there are cycles, they are not fixed in time.
</p>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="series-temporales.html#cb13-1" tabindex="-1"></a></span>
<span id="cb13-2"><a href="series-temporales.html#cb13-2" tabindex="-1"></a><span class="fu">plot.ts</span>(electricity.ts, <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;kW/h&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-145"></span>
<img src="_main_files/figure-html/unnamed-chunk-145-1.png" alt="\label{fig:trendy}Clear trend indicates this is not a stationary series." width="480" />
<p class="caption">
Figure 6.2: Clear trend indicates this is not a stationary series.
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="series-temporales.html#cb14-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb14-2"><a href="series-temporales.html#cb14-2" tabindex="-1"></a><span class="fu">acf</span>(lynx.ts)</span>
<span id="cb14-3"><a href="series-temporales.html#cb14-3" tabindex="-1"></a><span class="fu">acf</span>(electricity.ts)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-146"></span>
<img src="_main_files/figure-html/unnamed-chunk-146-1.png" alt="\label{fig:acf}Lynx trapped ACF plot (left) and kilowatts per hour in Australia ACF plot (right)." width="672" />
<p class="caption">
Figure 6.3: Lynx trapped ACF plot (left) and kilowatts per hour in Australia ACF plot (right).
</p>
</div>
<div id="parameters-in-arima-methods." class="section level3 hasAnchor" number="6.15.1">
<h3><span class="header-section-number">6.15.1</span> Parameters in ARIMA methods.<a href="series-temporales.html#parameters-in-arima-methods." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Therefore, in an ARIMA model we will use three parameters: (<em>p</em>, <em>d</em>, <em>q</em>).</p>
<ul>
<li><strong>p</strong>: refers to the use of past values of the series. It specifies the number of lags used in the model. For example, AR(2) or, ARIMA(2,0,0) specifies the use of two lags of the series.</li>
<li><strong>d</strong>: degree of differentiation. Differencing your current and previous values <em>d</em> times.</li>
<li><strong>q</strong>: model error as a combination of q previous error terms.</li>
</ul>
<p>ARIMA works best for long and stable series.</p>
</div>
</div>
<div id="non-seasonal-arima-models" class="section level2 hasAnchor" number="6.16">
<h2><span class="header-section-number">6.16</span> Non-seasonal ARIMA models<a href="series-temporales.html#non-seasonal-arima-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If we combine differencing and autoregression we obtain a non-seasonal ARIMA model:
<span class="math display">\[
y&#39;_t = c + \phi_1y&#39;_{t-1}+\cdots+\phi_py&#39;_{t-p}+\theta_1\epsilon_{t-1}+\cdots+\theta_q\epsilon_{t-q}+\epsilon_t
\]</span>
where <span class="math inline">\(y&#39;_t\)</span> is the series to which differencing has been applied. These models are represented as ARIMA(<span class="math inline">\(p,d,q\)</span>), where <span class="math inline">\(d\)</span> represents the degree of differencing.</p>
</div>
<div id="auto-arima-model" class="section level2 hasAnchor" number="6.17">
<h2><span class="header-section-number">6.17</span> Auto-ARIMA model<a href="series-temporales.html#auto-arima-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In R we have functions that automatically calculate the parameter values of an ARIMA model.</p>
<p>The <em><code>auto.arima()</code></em> function is a modification of the <strong>Hyndman-Khandakar</strong> algorithm.</p>
<p>R’s <code>auto.arima()</code> function combines tests, and minimisations to obtain an ARIMA model. By default, it can use initial approximations to speed up the model search (<code>approximation=TRUE/FALSE</code>).</p>
<p>If this does not allow to find a good model (minimum AICc) a larger set of models can be searched with the argument <code>stepwise=FALSE</code>. See <span class="citation">(<a href="#ref-forecasting"><strong>forecasting?</strong></a>)</span> for more on this topic.</p>
<p>To choose a custom model for a non-seasonal series, we will use the <code>Arima()</code> function as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Draw the dataset and identify outliers.</p></li>
<li><p>Transform the data to stabilise the variance.</p></li>
<li><p>If the data is not stationary use differencing until it is.</p></li>
<li><p>Analyse ACF/PACF for an ARIMA(<span class="math inline">\(p,d,0\)</span>) or ARIMA(<span class="math inline">\(0,d,q\)</span>) model.</p></li>
<li><p>Try to pick your model and use AICc to find the best one.</p></li>
<li><p>Check that the residuals behave like white noise:</p></li>
</ol>
<ul>
<li>if this is not satisfied look for another model</li>
<li>if this is true, we can use the model to predict</li>
</ul>
</div>
<div id="example-temperature-forecast-in-malaga---modelos-arima" class="section level2 hasAnchor" number="6.18">
<h2><span class="header-section-number">6.18</span> Example: Temperature forecast in Malaga - Modelos ARIMA<a href="series-temporales.html#example-temperature-forecast-in-malaga---modelos-arima" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Analyse the evolution of the minimum temperatures since 2001 in Malaga <strong>with the methods seen in this document</strong>.</p>
<p>We obtain a time-series object with the <code>ts</code> function, as our data are divided into months, we set the parameter <em>frequency</em> to 12 and we indicate that we start in January 2001. Then we draw the object obtained:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-148-1.png" width="480" style="display: block; margin: auto;" /></p>
<p><strong><em>ARIMA models</em></strong></p>
<p>We decompose the data: <em>Seasonal component</em>, <em>Trend component</em>, <em>Cycle component</em> y <em>residual</em>.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-149-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Previously we have seen that the series is stationary, but to fit an ARIMA model requires the series to be stationary.</p>
<pre><code>Augmented Dickey-Fuller Test</code></pre>
<p>data: obj.ts
Dickey-Fuller = -14.33, Lag order = 5, p-value = 0.01
alternative hypothesis: stationary</p>
<p>We see that it is stationary.</p>
<p>We fix an ARIMA model using auto.arima:</p>
<p>Series: deseasonal_cnt
ARIMA(1,1,1)</p>
<p>Coefficients:
ar1 ma1
0.3684 -0.9799
s.e. 0.0668 0.0175</p>
<p>sigma^2 = 0.7702: log likelihood = -274.66
AIC=555.32 AICc=555.44 BIC=565.41</p>
<p><img src="_main_files/figure-html/unnamed-chunk-152-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>As we can see, even lag=23 is equal, so p or q is 23.</p>
<p>Call:
arima(x = deseasonal_cnt, order = c(1, 1, 23))</p>
<p>Coefficients:
ar1 ma1 ma2 ma3 ma4 ma5 ma6 ma7
-0.7624 0.1627 -0.6937 -0.1923 -0.0753 0.0409 -0.1322 -0.0993
s.e. 0.2475 0.2563 0.1611 0.1147 0.0880 0.0930 0.1067 0.1014
ma8 ma9 ma10 ma11 ma12 ma13 ma14 ma15 ma16
0.0485 0.2009 0.0295 -0.2316 -0.1224 -0.1785 0.0240 0.3970 0.1431
s.e. 0.0936 0.0982 0.0963 0.1006 0.0939 0.0922 0.0978 0.1027 0.1168
ma17 ma18 ma19 ma20 ma21 ma22 ma23
-0.1927 -0.2143 0.0691 0.1088 0.1423 -0.0907 -0.0931
s.e. 0.0902 0.1099 0.0969 0.1216 0.1053 0.1051 0.1117</p>
<p>sigma^2 estimated as 0.6437: log likelihood = -261.09, aic = 572.19
<img src="_main_files/figure-html/unnamed-chunk-153-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>We forecast for the next 30 months:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-154-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="references" class="section level2 hasAnchor" number="6.19">
<h2><span class="header-section-number">6.19</span> References<a href="series-temporales.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Information and images obtained from:</p>
<p><a href="https://otexts.org/fpp2/">Forecasting: Principles and Practice. Rob J Hyndman and George Athanasopoulos. Monash University, Australia</a></p>
<p><a href="https://www.datascience.com/blog/introduction-to-forecasting-with-arima-in-r-learn-data-science-tutorials">Introducion to Forecasting with ARIMA in R</a></p>
<p><a href="Los%20datos%20han%20sido%20obtenidos%20de%20%5Baemet%5D(http://www.aemet.es/es/portada)">AEMET</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelling-techniques.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="clustering.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-seriestemporales.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
